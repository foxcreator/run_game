# Аналіз реалізації пікапів (гроші + 4 бонуси)

## ✅ Що вже зроблено:

### 6.1 Гроші
- ✅ **Coin клас** - реалізовано (`src/entities/Coin.js`)
  - Значення монети: 1
  - Анімація обертання
  - Метод `collect()` для видалення

- ✅ **Run money** - реалізовано
  - `GameScene.runMoney` - зберігає гроші за поточний забіг
  - Додається при зборі монет (`handlePickupCollision`)

- ✅ **Banked money** - реалізовано
  - `SaveSystem.getBankedMoney()` / `setBankedMoney()` / `addBankedMoney()`
  - Зберігається в localStorage
  - Додається після смерті в `handleGameOver()`

- ✅ **Відображення в HUD**
  - Показує "Зароблено: $X | Банк: $Y"
  - Оновлюється в реальному часі

### 6.2 Бонуси (MVP 4)

#### 1. Енергетик ✅
- ✅ Клас `EnergyDrink` (`src/entities/bonuses/EnergyDrink.js`)
- ✅ `stamina += 35` з clamp до max
- ✅ Скидає exhausted стан якщо був

#### 2. Скутер ✅
- ✅ Клас `Scooter` (`src/entities/bonuses/Scooter.js`)
- ✅ `speedMultiplier += 0.5` на 2.0 сек
- ✅ Імунітет до SoftCrowd на 2.0 сек
- ✅ Player має методи `addSpeedBuff()` та `addImmunityToSoftCrowd()`

#### 3. Жарт ✅
- ✅ Клас `Joke` (`src/entities/bonuses/Joke.js`)
- ✅ `capture -= 30` (через `captureSystem.addCapture(-30)`)
- ✅ Всі вороги `speed *= 0.7` на 1.0 сек
- ✅ Chaser має метод `applySpeedDebuff()`

#### 4. Димова хмарка ✅
- ✅ Клас `SmokeCloud` (`src/entities/bonuses/SmokeCloud.js`)
- ✅ Вороги втрачають лок на 1.2 сек
- ✅ Рухаються до останньої відомої позиції
- ✅ Chaser має метод `loseLock()` та логіку руху до `lastKnownPlayerPos`

### Спавн пікапів
- ✅ Метод `spawnPickups()` в GameScene
- ✅ Спавн монет: 6-10 (з конфігу)
- ✅ Спавн бонусів: 1-3 (з конфігу)
- ✅ Валідація позицій (прохідність, відстань від гравця)

### Колізії
- ✅ `handlePickupCollision()` обробляє зіткнення
- ✅ Видалення пікапів після збору
- ✅ Оновлення `runMoney` при зборі монет

## ⚠️ Що потрібно полірувати:

### 1. Процедурний спавн пікапів (критично!)
**Проблема:** `spawnPickups()` викликається тільки один раз при `create()`, а не підтримує кількість під час гри.

**Згідно MVP 8.3:**
- Пікапи-гроші: 6-10 активних (підтримувати)
- Бонуси: 1-3 активних (рідко, підтримувати)

**Потрібно:**
- Додати систему підтримки кількості пікапів
- Перевіряти кожну секунду (або в `update()`)
- Доспавнювати монети/бонуси якщо їх менше ніж мінімум
- Видаляти пікапи які далеко позаду гравця

### 2. Перевірка роботи бонусів
- [ ] Перевірити чи правильно працює `addSpeedBuff()` в Player
- [ ] Перевірити чи правильно працює `addImmunityToSoftCrowd()` в Player
- [ ] Перевірити чи правильно працює `applySpeedDebuff()` в Chaser
- [ ] Перевірити чи правильно працює `loseLock()` в Chaser
- [ ] Перевірити чи оновлюються таймери дебафів/бафів

### 3. Відображення активних бафів
- [ ] Перевірити чи HUD показує активні бафи (icons)
- [ ] Перевірити чи правильно відображаються таймери бафів

### 4. Додавання грошей в мета
- ✅ Реалізовано в `handleGameOver()`
- [ ] Перевірити чи правильно працює на практиці
- [ ] Перевірити чи гроші зберігаються в localStorage

### 5. Оптимізація
- [ ] Видалення пікапів які далеко позаду (cleanup)
- [ ] Обмеження максимальної кількості пікапів на карті

## План полірування:

1. **Додати систему підтримки кількості пікапів** (найважливіше!)
2. **Перевірити всі бонуси в дії**
3. **Додати cleanup пікапів позаду гравця**
4. **Перевірити збереження грошей**
